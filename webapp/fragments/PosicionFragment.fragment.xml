<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout.form"
>
    <!-- Contenedor principal vertical -->
    <VBox
        id="_IDGenVBox2"
        width="100%"
        fitContainer="true"
        class="sapUiMediumMargin"
    >
        <!-- Formulario para datos de posición -->
        <layout:SimpleForm
            id="_IDGenSimpleForm1"
            editable="true"
            layout="ResponsiveGridLayout"
            labelSpanL="4"
            labelSpanM="4"
            labelSpanS="12"
            adjustLabelSpan="false"
            emptySpanL="4"
            emptySpanM="4"
            emptySpanS="0"
            columnsL="1"
            columnsM="1"
            singleContainerFullSize="true"
            class="sapUiForm sapUiSizeCompact"
            title="{i18n>datosPosicion}"
        >
            <layout:content>
                <!-- Material -->
                <Label
                    id="materialLabel"
                    text="{i18n>material}"
                    design="Bold"
                    required="true"
                />
                <HBox
                    id="_IDGenHBox2"
                    alignItems="Center"
                    class="sapUiMediumMarginBottom"
                >
                    <Input
                        id="material"
                        value="{mainModel>/currentItem/material}"
                        valueState="{mainModel>/currentItem/materialState}"
                        valueStateText="{mainModel>/currentItem/materialStateText}"
                        submit=".onMaterialScanned"
                        placeholder="{i18n>ingreseMaterial}"
                    />
                    <Button
                        id="scanMaterial"
                        icon="sap-icon://bar-code"
                        tooltip="{i18n>scanMaterial}"
                        press=".onScanMaterial"
                        type="Transparent"
                        class="sapUiSmallMarginBegin"
                    />
                </HBox>

                <!-- Cantidad -->
                <Label
                    id="entryQntLabel"
                    text="{i18n>cantidad}"
                    design="Bold"
                    required="true"
                />
                <Input
                    id="entryQnt"
                    value="{mainModel>/currentItem/entry_qnt}"
                    valueState="{mainModel>/currentItem/quantityState}"
                    valueStateText="{mainModel>/currentItem/quantityStateText}"
                    change=".onQuantityChange"
                    placeholder="{i18n>ingreseCantidad}"
                    type="Number"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Unidad de medida -->
                <Label
                    id="entryUomLabel"
                    text="{i18n>um}"
                    design="Bold"
                    required="true"
                />
                <Input
                    id="entryUom"
                    value="{mainModel>/currentItem/entry_uom}"
                    placeholder="{i18n>ingreseUM}"
                    enabled="false"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Lote -->
                <Label
                    id="batchLabel"
                    text="{i18n>lote}"
                    design="Bold"
                    required="{mainModel>/currentItem/isBatchRequired}"
                />
                <Input
                    id="batch"
                    value="{mainModel>/currentItem/batch}"
                    enabled="{mainModel>/currentItem/isBatchRequired}"
                    placeholder="{i18n>ingreseLote}"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Centro -->
                <Label
                    id="plantLabel"
                    text="{i18n>centro}"
                    design="Bold"
                    required="true"
                />
                <Input
                    id="plant"
                    value="{mainModel>/currentItem/plant}"
                    placeholder="{i18n>ingreseCentro}"
                    enabled="false"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Almacén -->
                <Label
                    id="stgeLocLabel"
                    text="{i18n>almacen}"
                    design="Bold"
                    required="true"
                />
                <Input
                    id="stgeLoc"
                    value="{mainModel>/currentItem/stge_loc}"
                    placeholder="{i18n>ingreseAlmacen}"
                    enabled="false"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Centro de costo -->
                <Label
                    id="costcenterLabel"
                    text="{i18n>ceco}"
                    design="Bold"
                    required="{= ${mainModel>/savedHeader/move_type} === '201' || ${mainModel>/savedHeader/move_type} === '551'}"
                />
                <Input
                    id="costcenter"
                    value="{mainModel>/currentItem/costcenter}"
                    visible="{= ${mainModel>/savedHeader/move_type} === '201' || ${mainModel>/savedHeader/move_type} === '551'}"
                    placeholder="{i18n>ingreseCeco}"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Motivo -->
                <Label
                    id="moveReasLabel"
                    text="{i18n>motivo}"
                    design="Bold"
                />
                <Input
                    id="moveReas"
                    value="{mainModel>/currentItem/move_reas}"
                    placeholder="{i18n>seleccionarMotivo}"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Texto de posición -->
                <Label
                    id="positionTxtLabel"
                    text="{i18n>txt_posicion}"
                    design="Bold"
                />
                <TextArea
                    id="positionTxt"
                    value="{mainModel>/currentItem/position_txt}"
                    rows="3"
                    growing="true"
                    maxLength="40"
                    placeholder="{i18n>ingreseTextoPosicion}"
                    class="sapUiMediumMarginBottom"
                />

                <!-- Historial de texto de posición -->
                <Label
                    id="positionTxtHistoryLabel"
                    text="{i18n>historial_texto_posicion}"
                    design="Bold"
                />
                <TextArea
                    id="positionTxtHistory"
                    value="{mainModel>/currentItem/position_txt_history}"
                    editable="false"
                    rows="5"
                    class="sapUiMediumMarginBottom"
                />
            </layout:content>
        </layout:SimpleForm>

        <!-- Botones de acción -->
        <HBox
            id="_IDGenHBox1"
            justifyContent="End"
            alignItems="Center"
            width="95%"
            class="sapUiMediumMargin"
        >
            <Button
                id="fetchDetails"
                text="{i18n>fetchDetails}"
                type="Emphasized"
                press=".onFetchDetails"
                icon="sap-icon://detail-view"
                class="sapUiTinyMarginEnd customCompactButton"
            />
            <Button
                id="saveItem"
                text="{i18n>contabilizar}"
                type="Accept"
                press=".onSaveItem"
                icon="sap-icon://sys-enter"
                class="sapUiTinyMarginEnd customCompactButton"
            />
            <Button
                id="cancelItem"
                text="{i18n>cancelar}"
                type="Reject"
                press=".onCancelItem"
                icon="sap-icon://decline"
                class="sapUiTinyMarginEnd customCompactButton"
            />
        </HBox>
    </VBox>
</core:FragmentDefinition>
